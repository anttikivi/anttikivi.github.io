---
import MainLayout from "@/layouts/MainLayout.astro";
import locales, { defaultLocale, type Locale } from "@/locales";
import type { GetStaticPathsResult } from "astro";
import { getEntry, render } from "astro:content";

export function getStaticPaths(): GetStaticPathsResult {
    let paths = [];

    for (const locale of locales as Locale[]) {
        if (locale === defaultLocale) {
            paths.push({
                params: { locale: undefined },
            });
        } else {
            paths.push({
                params: { locale },
            });
        }
    }

    return paths;
}

const page = await getEntry("home", Astro.currentLocale as string);

if (!page) {
    throw new Error(`could not load content for entry home/preface-${Astro.currentLocale}`);
}

const { Content } = await render(page);
---

<MainLayout title={page.data.title}>
    <h1>Astro</h1>
    <Content />
</MainLayout>
